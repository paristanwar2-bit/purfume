document.addEventListener("DOMContentLoaded", () => {

    // ---------------- NAVBAR ----------------
    function mobileMenuToggle() {
        document.getElementById("menu").classList.toggle("open");
    }


    // ---------------- QTY POPUP ----------------
    const qty = document.getElementById("qty");
    const plus = document.getElementById("plus");
    const minus = document.getElementById("minus");

    if (plus && minus && qty) {
        plus.addEventListener("click", () => {
            qty.value = Number(qty.value) + 1;
        });

        minus.addEventListener("click", () => {
            if (qty.value > 1) {
                qty.value = Number(qty.value) - 1;
            }
        });
    }


    // ---------------- PRODUCT POPUP ----------------
    const viewButtons = document.querySelectorAll(".view-btn");
    const popup = document.getElementById("popupModal");

    const popupImg = document.getElementById("popupImg");
    const popupTitle = document.getElementById("popupTitle");
    const popupOldPrice = document.getElementById("popupOldPrice");
    const popupNewPrice = document.getElementById("popupNewPrice");

    const closePopup = document.getElementById("closePopup");

    viewButtons.forEach(btn => {
        btn.addEventListener("click", () => {
            popupImg.src = btn.dataset.img;
            popupTitle.textContent = btn.dataset.title;
            popupOldPrice.textContent = btn.dataset.old;
            popupNewPrice.textContent = btn.dataset.new;

            popup.style.display = "flex";
        });
    });

    if (closePopup) {
        closePopup.addEventListener("click", () => {
            popup.style.display = "none";
        });
    }


    // ---------------- ACCORDION ----------------
    document.querySelectorAll(".accordion-btn").forEach(btn => {
        btn.addEventListener("click", () => {
            btn.nextElementSibling.classList.toggle("open");
        });
    });


    // ---------------- FILTER FUNCTION ----------------
    const filters = document.querySelectorAll(".filter");
    const cards = document.querySelectorAll(".card");

    filters.forEach(f => {
        f.addEventListener("click", () => {

            filters.forEach(x => x.classList.remove("active"));
            f.classList.add("active");

            let cat = f.dataset.category;

            cards.forEach(card => {
                card.style.display =
                    (cat === "all" || card.dataset.category === cat)
                        ? "block" : "none";
            });

            // MOBILE AUTO CLOSE
            if (window.innerWidth <= 768) {
                document.getElementById("mobileFilterBox")?.classList.remove("open");
                document.getElementById("filterOverlay").style.display = "none";
            }
        });
    });


    // ---------------- MOBILE FILTER BOX ----------------
    const mobileBtn = document.querySelector(".mobile-filter-btn");
    const mobileBox = document.getElementById("mobileFilterBox");
    const overlay = document.getElementById("filterOverlay");
    const closeBtn = document.querySelector(".closeMobileFilter");

    if (mobileBtn) {
        mobileBtn.onclick = () => {
            mobileBox.classList.add("open");
            overlay.style.display = "block";
        };
    }

    function closeFilter() {
        mobileBox.classList.remove("open");
        overlay.style.display = "none";
    }

    if (closeBtn) closeBtn.onclick = closeFilter;
    if (overlay) overlay.onclick = closeFilter;

});
